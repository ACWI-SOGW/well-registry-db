FROM usgswma/iow_test_db:postgis10-11.0.3

LABEL maintainer=gs-w_eto_eb_federal_employees@usgs.gov

ARG DEFAULT_PASSWORD=changeMe
ARG DEFAULT_DATABASE_NAME=database_name
ARG DEFAULT_DATABASE_ADDRESS=127.0.0.1
ARG DEFAULT_DB_OWNER_USERNAME=db_owner
ARG DEFAULT_SCHEMA_OWNER_USERNAME=schema_owner
ARG DEFAULT_SCHEMA_NAME=schema_name

ARG POSTGRES_PASSWORD="${DEFAULT_PASSWORD}"
ENV POSTGRES_PASSWORD="${POSTGRES_PASSWORD}"

ARG DATABASE_HOST="${DEFAULT_DATABASE_ADDRESS}"
ENV DATABASE_HOST="${DATABASE_HOST}"
ARG APP_DATABASE_NAME="${DEFAULT_DATABASE_NAME}"
ENV APP_DATABASE_NAME="${APP_DATABASE_NAME}"
ARG APP_DB_OWNER_USERNAME="${DEFAULT_DB_OWNER_USERNAME}"
ENV APP_DB_OWNER_USERNAME="${APP_DB_OWNER_USERNAME}"
ARG APP_DB_OWNER_PASSWORD="${DEFAULT_PASSWORD}"
ENV APP_DB_OWNER_PASSWORD="${APP_DB_OWNER_PASSWORD}"
ARG APP_SCHEMA_NAME=${DEFAULT_SCHEMA_NAME}
ENV APP_SCHEMA_NAME="${APP_SCHEMA_NAME}"
ARG APP_SCHEMA_OWNER_USERNAME=${DEFAULT_SCHEMA_OWNER_USERNAME}
ENV APP_SCHEMA_OWNER_USERNAME="${APP_SCHEMA_OWNER_USERNAME}"
ARG APP_SCHEMA_OWNER_PASSWORD="${DEFAULT_PASSWORD}"
ENV APP_SCHEMA_OWNER_PASSWORD="${APP_SCHEMA_OWNER_PASSWORD}"

############################################
# Grab files for initializing the database
############################################

COPY ./liquibase/changeLogs $LIQUIBASE_WORKSPACE
COPY ./liquibase/scripts/*.sh /docker-entrypoint-initdb.d/
COPY ./liquibase/scripts/dbInit /docker-entrypoint-initdb.d/
